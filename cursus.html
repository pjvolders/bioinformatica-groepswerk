<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Bio-informatica groepswerk handleiding</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="cursus_files/libs/clipboard/clipboard.min.js"></script>
<script src="cursus_files/libs/quarto-html/quarto.js"></script>
<script src="cursus_files/libs/quarto-html/popper.min.js"></script>
<script src="cursus_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="cursus_files/libs/quarto-html/anchor.min.js"></script>
<link href="cursus_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="cursus_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="cursus_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="cursus_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="cursus_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introductie" id="toc-introductie" class="nav-link active" data-scroll-target="#introductie">Introductie</a></li>
  <li><a href="#vscode-op-de-vlaamse-supercomputer-centrum-infrastructuur" id="toc-vscode-op-de-vlaamse-supercomputer-centrum-infrastructuur" class="nav-link" data-scroll-target="#vscode-op-de-vlaamse-supercomputer-centrum-infrastructuur">VSCode op de Vlaamse Supercomputer Centrum infrastructuur</a></li>
  <li><a href="#introductie-tot-linux-shellbash" id="toc-introductie-tot-linux-shellbash" class="nav-link" data-scroll-target="#introductie-tot-linux-shellbash">Introductie tot Linux Shell/Bash</a>
  <ul class="collapse">
  <li><a href="#wat-is-een-shell" id="toc-wat-is-een-shell" class="nav-link" data-scroll-target="#wat-is-een-shell">Wat is een Shell?</a></li>
  <li><a href="#basisbegrippen" id="toc-basisbegrippen" class="nav-link" data-scroll-target="#basisbegrippen">Basisbegrippen</a></li>
  <li><a href="#basisopdrachten" id="toc-basisopdrachten" class="nav-link" data-scroll-target="#basisopdrachten">Basisopdrachten</a>
  <ul class="collapse">
  <li><a href="#pwd-print-working-directory" id="toc-pwd-print-working-directory" class="nav-link" data-scroll-target="#pwd-print-working-directory"><code>pwd</code> (Print Working Directory)</a></li>
  <li><a href="#ls-list" id="toc-ls-list" class="nav-link" data-scroll-target="#ls-list"><code>ls</code> (List)</a></li>
  <li><a href="#cd-change-directory" id="toc-cd-change-directory" class="nav-link" data-scroll-target="#cd-change-directory"><code>cd</code> (Change Directory)</a></li>
  <li><a href="#mkdir-make-directory" id="toc-mkdir-make-directory" class="nav-link" data-scroll-target="#mkdir-make-directory"><code>mkdir</code> (Make Directory)</a></li>
  <li><a href="#cp-copy" id="toc-cp-copy" class="nav-link" data-scroll-target="#cp-copy"><code>cp</code> (Copy)</a></li>
  <li><a href="#mv-move" id="toc-mv-move" class="nav-link" data-scroll-target="#mv-move"><code>mv</code> (Move)</a></li>
  <li><a href="#rm-remove" id="toc-rm-remove" class="nav-link" data-scroll-target="#rm-remove"><code>rm</code> (Remove)</a></li>
  <li><a href="#cat-concatenate" id="toc-cat-concatenate" class="nav-link" data-scroll-target="#cat-concatenate"><code>cat</code> (Concatenate)</a></li>
  <li><a href="#echo" id="toc-echo" class="nav-link" data-scroll-target="#echo"><code>echo</code></a></li>
  </ul></li>
  <li><a href="#opdrachtstructuur" id="toc-opdrachtstructuur" class="nav-link" data-scroll-target="#opdrachtstructuur">Opdrachtstructuur</a></li>
  <li><a href="#tips" id="toc-tips" class="nav-link" data-scroll-target="#tips">Tips</a></li>
  <li><a href="#oefenopdrachten" id="toc-oefenopdrachten" class="nav-link" data-scroll-target="#oefenopdrachten">Oefenopdrachten</a></li>
  </ul></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#kwaliteitscontrole-met-fastqc" id="toc-kwaliteitscontrole-met-fastqc" class="nav-link" data-scroll-target="#kwaliteitscontrole-met-fastqc">Kwaliteitscontrole met FastQC</a>
  <ul class="collapse">
  <li><a href="#doel" id="toc-doel" class="nav-link" data-scroll-target="#doel">Doel</a></li>
  <li><a href="#opdrachten" id="toc-opdrachten" class="nav-link" data-scroll-target="#opdrachten">Opdrachten</a></li>
  <li><a href="#het-interpreteren-van-het-fastqc-html-rapport" id="toc-het-interpreteren-van-het-fastqc-html-rapport" class="nav-link" data-scroll-target="#het-interpreteren-van-het-fastqc-html-rapport">Het interpreteren van het FastQC HTML-rapport</a></li>
  <li><a href="#opdrachtvragen" id="toc-opdrachtvragen" class="nav-link" data-scroll-target="#opdrachtvragen">Opdrachtvragen:</a></li>
  </ul></li>
  <li><a href="#read-mapping-met-bwa" id="toc-read-mapping-met-bwa" class="nav-link" data-scroll-target="#read-mapping-met-bwa">Read Mapping met BWA</a>
  <ul class="collapse">
  <li><a href="#opdrachtvragen-1" id="toc-opdrachtvragen-1" class="nav-link" data-scroll-target="#opdrachtvragen-1">Opdrachtvragen:</a></li>
  </ul></li>
  <li><a href="#variant-calling-met-bcftools" id="toc-variant-calling-met-bcftools" class="nav-link" data-scroll-target="#variant-calling-met-bcftools">Variant Calling met BCFtools</a></li>
  <li><a href="#variant-filtering" id="toc-variant-filtering" class="nav-link" data-scroll-target="#variant-filtering">Variant Filtering</a></li>
  <li><a href="#variant-annotatie-met-snpeff" id="toc-variant-annotatie-met-snpeff" class="nav-link" data-scroll-target="#variant-annotatie-met-snpeff">Variant Annotatie met SnpEff</a>
  <ul class="collapse">
  <li><a href="#stap-1-installeer-snpeff" id="toc-stap-1-installeer-snpeff" class="nav-link" data-scroll-target="#stap-1-installeer-snpeff">Stap 1: Installeer SnpEff</a></li>
  <li><a href="#stap-2-download-de-human-genome-database" id="toc-stap-2-download-de-human-genome-database" class="nav-link" data-scroll-target="#stap-2-download-de-human-genome-database">Stap 2: Download de Human Genome Database</a></li>
  <li><a href="#stap-3-voer-snpeff-uit" id="toc-stap-3-voer-snpeff-uit" class="nav-link" data-scroll-target="#stap-3-voer-snpeff-uit">Stap 3: Voer SnpEff uit</a></li>
  <li><a href="#stap-4-interpreteer-de-resultaten" id="toc-stap-4-interpreteer-de-resultaten" class="nav-link" data-scroll-target="#stap-4-interpreteer-de-resultaten">Stap 4: Interpreteer de Resultaten</a></li>
  <li><a href="#opdrachtvragen-2" id="toc-opdrachtvragen-2" class="nav-link" data-scroll-target="#opdrachtvragen-2">Opdrachtvragen</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="cursus.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bio-informatica groepswerk handleiding</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introductie" class="level1">
<h1>Introductie</h1>
<p>Somatische varianten zijn genetische veranderingen die niet overgeërfd zijn, maar tijdens iemands leven in specifieke cellen ontstaan. Deze varianten zijn vooral belangrijk in de context van kanker, waar ze een cruciale rol spelen bij het ontstaan en de progressie van de ziekte. Het doel van somatische variant calling is om deze niet-geërfde mutaties te identificeren in DNA sequencing data van tumoren en andere stalen.</p>
<p>Dit proces omvat:</p>
<ol type="1">
<li>Sequencing van tumorweefsel of bloedcellen van een patiënt.</li>
<li>Alignment van de sequentiedata aan een referentiegenoom.</li>
<li>Identificatie van posities waar de tumorsequentie verschilt van het referentiegenoom. Dit noemen we varianten.</li>
<li>Filteren van deze varianten om</li>
</ol>
<p>Het belang van somatische variant calling ligt in verschillende gebieden:</p>
<ul>
<li><strong>Kankerdiagnostiek:</strong> Het helpt bij het identificeren van de specifieke mutaties die een rol spelen in een individuele tumor.</li>
<li><strong>Gepersonaliseerde behandeling:</strong> Kennis van de somatische varianten kan helpen bij het kiezen van de meest effectieve behandeling voor een patiënt.</li>
<li><strong>Onderzoek:</strong> Het draagt bij aan ons begrip van de genetische basis van kanker en andere ziekten.</li>
<li><strong>Monitoring:</strong> Het kan worden gebruikt om de evolutie van een tumor in de tijd te volgen en de respons op behandeling te evalueren.</li>
</ul>
<p>In dit groepswerk doorlopen we de stappen die nodig zijn om somatische variant calling uit te voeren. We leren de basisprincipes van sequentieanalyse en specifieke uitdagingen van het identificeren van somatische mutaties. Hierbij reflecteren we bij elke stap over de verkregen resultaten.</p>
</section>
<section id="vscode-op-de-vlaamse-supercomputer-centrum-infrastructuur" class="level1">
<h1>VSCode op de Vlaamse Supercomputer Centrum infrastructuur</h1>
<p>We kunnen de VSC (Vlaamse Supercomputer Centrum) infrastructuur op verschillende manieren gebruiken. De meest gebruiksvriendelijke manier is het <em>KU Leuven OnDemand</em> platform. Om in te loggen op dit platform doorloop je volgende stappen:</p>
<ol type="1">
<li>Surf met je browser naar <a href="https://ondemand.hpc.kuleuven.be/">https://ondemand.hpc.kuleuven.be</a></li>
<li>Kies hier de optie om in te loggen met een VSC account: “Partner organizations: VSC account”</li>
<li>Log in met je UHasselt account</li>
<li>Bij de vraag “Authorize vsc-challenge?” antwoord je “Authorize”</li>
</ol>
<p>Je bent nu ingelogd op het <em>KU Leuven OnDemand</em> platform. Hiermee kan je vanuit je webbrowser een aantal populaire applicaties opstarten op de Vlaamse SuperComputer. Meer achtergrond kan je vinden in de <a href="https://docs.vscentrum.be/leuven/services/openondemand.html">handleiding</a>.</p>
<p>Voor het groepswerk gaan we gebruik maken van de Visual Studio Code (VS Code) applicatie. Dit is een populaire applicatie om code te schrijven die een ingebouwde bestands browser en <em>terminal</em> vensters heeft. Om VS Code te starten via het OnDemand platform doorloop je de volgende stappen.</p>
<ol type="1">
<li>Klik op het “code-server” icoon.</li>
<li>Er verschijnt een formulier met een aantal opties. Controleer volgende opties en pas aan indien nodig.
<ul>
<li><strong>Account:</strong> lp_h_edu_bioinformatics_2024</li>
<li><strong>Number of hours:</strong> 1</li>
<li><strong>Number of cores:</strong>: 2</li>
<li><strong>Required memory per core in megabytes:</strong>: 3400</li>
</ul></li>
<li>Klik op “Launch”</li>
<li>Een overzicht van jouw recent sessies verschijnt met bovenaan de VS Code sessie met status “Queued”</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="cursus_images/ondemand_queue.png" class="img-fluid figure-img"></p>
<figcaption>Queued</figcaption>
</figure>
</div>
<p>Nu moet je even wachten tot de VS Code sessie gestart is. Normaal duurt dit maar enkele seconden. Het zou mogelijk zijn dat je ook wat langer moet wachten als de VSC infrastructuur druk bezet is. Wanneer de sessie gestart is verschijnt “Running” en wordt het kader groen:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="cursus_images/ondemand_ready.png" class="img-fluid figure-img"></p>
<figcaption>Ready</figcaption>
</figure>
</div>
<p>Klik nu op “Connect to Visual Studio Code”. De VS Code interface verschijnt.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="cursus_images/vscode_home.png" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
</section>
<section id="introductie-tot-linux-shellbash" class="level1">
<h1>Introductie tot Linux Shell/Bash</h1>
<section id="wat-is-een-shell" class="level2">
<h2 class="anchored" data-anchor-id="wat-is-een-shell">Wat is een Shell?</h2>
<p>Een shell is een programma dat een interface biedt voor gebruikers om met het besturingssysteem te communiceren. De meest voorkomende shell in Linux-systemen heet Bash (Bourne Again SHell). Wanneer je de opdrachtregel gebruikt, typ je opdrachten in de shell.</p>
</section>
<section id="basisbegrippen" class="level2">
<h2 class="anchored" data-anchor-id="basisbegrippen">Basisbegrippen</h2>
<ol type="1">
<li><p><strong>Opdrachtprompt</strong>: Hier typ je je opdrachten. Het eindigt meestal met een <code>$</code>-teken.</p></li>
<li><p><strong>Opdrachten</strong>: Dit zijn instructies die je aan de computer geeft.</p></li>
<li><p><strong>Argumenten</strong>: Aanvullende informatie die je aan een opdracht geeft.</p></li>
<li><p><strong>Opties</strong>: Wijzigen het gedrag van opdrachten, meestal beginnend met een streepje (<code>-</code>).</p></li>
</ol>
</section>
<section id="basisopdrachten" class="level2">
<h2 class="anchored" data-anchor-id="basisopdrachten">Basisopdrachten</h2>
<section id="pwd-print-working-directory" class="level3">
<h3 class="anchored" data-anchor-id="pwd-print-working-directory"><code>pwd</code> (Print Working Directory)</h3>
<p>Toont je huidige locatie in het bestandssysteem.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> pwd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/gebruikersnaam</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ls-list" class="level3">
<h3 class="anchored" data-anchor-id="ls-list"><code>ls</code> (List)</h3>
<p>Geeft een lijst van bestanden en mappen in de huidige directory.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ls</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Documenten</span>  Downloads  Afbeeldingen  Muziek</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Opties:</p>
<ul>
<li><code>ls -l</code>: Lang formaat, toont meer details</li>
<li><code>ls -a</code>: Toont verborgen bestanden (die beginnen met een punt)</li>
<li><code>ls -lh</code>: Toont de grootte van de bestanden (in de kolom) in een leesbaar formaat (<code>K</code>: kilobyte, <code>M</code>: megabyte, <code>G</code>: gigabyte).</li>
</ul>
</section>
<section id="cd-change-directory" class="level3">
<h3 class="anchored" data-anchor-id="cd-change-directory"><code>cd</code> (Change Directory)</h3>
<p>Verplaatst je naar een andere directory.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd Documenten</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Speciale directories:</p>
<ul>
<li><code>.</code> : Huidige directory</li>
<li><code>..</code>: Bovenliggende directory</li>
<li><code>~</code> : Thuisdirectory van de gebruiker</li>
</ul>
</section>
<section id="mkdir-make-directory" class="level3">
<h3 class="anchored" data-anchor-id="mkdir-make-directory"><code>mkdir</code> (Make Directory)</h3>
<p>Maakt een nieuwe directory aan.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> mkdir NieuweMap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="cp-copy" class="level3">
<h3 class="anchored" data-anchor-id="cp-copy"><code>cp</code> (Copy)</h3>
<p>Kopieert bestanden of directories.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cp bestand.txt Documenten/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Om een directory en zijn inhoud te kopiëren, gebruik de <code>-r</code> (recursief) optie:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cp <span class="at">-r</span> MapA MapB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="mv-move" class="level3">
<h3 class="anchored" data-anchor-id="mv-move"><code>mv</code> (Move)</h3>
<p>Verplaatst of hernoemt bestanden en directories.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> mv bestand.txt Documenten/</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> mv oudenaam.txt nieuwenaam.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="rm-remove" class="level3">
<h3 class="anchored" data-anchor-id="rm-remove"><code>rm</code> (Remove)</h3>
<p>Verwijdert bestanden of directories. Wees voorzichtig met deze opdracht!</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> rm bestand.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Om een directory en zijn inhoud te verwijderen, gebruik de <code>-r</code> optie:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> rm <span class="at">-r</span> MapNaam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="cat-concatenate" class="level3">
<h3 class="anchored" data-anchor-id="cat-concatenate"><code>cat</code> (Concatenate)</h3>
<p>Toont de inhoud van een bestand.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat bestand.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="echo" class="level3">
<h3 class="anchored" data-anchor-id="echo"><code>echo</code></h3>
<p>Print tekst naar het scherm.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Hallo, Wereld!"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Hallo,</span> Wereld!</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="opdrachtstructuur" class="level2">
<h2 class="anchored" data-anchor-id="opdrachtstructuur">Opdrachtstructuur</h2>
<p>De meeste opdrachten volgen deze structuur:</p>
<pre><code>opdracht [opties] [argumenten]</code></pre>
<p>Bijvoorbeeld:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span> Documenten</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Hier is <code>ls</code> de opdracht, <code>-l</code> een optie, en <code>Documenten</code> een argument.</p>
</section>
<section id="tips" class="level2">
<h2 class="anchored" data-anchor-id="tips">Tips</h2>
<ol type="1">
<li>Gebruik de pijltjestoetsen omhoog en omlaag om door je opdrachtgeschiedenis te navigeren.</li>
<li>Gebruik Tab voor automatische aanvulling van bestands- en mapnamen.</li>
<li>Gebruik <code>man</code> gevolgd door een opdrachtnaam om de handleiding te zien (bijv. <code>man ls</code>).</li>
</ol>
</section>
<section id="oefenopdrachten" class="level2">
<h2 class="anchored" data-anchor-id="oefenopdrachten">Oefenopdrachten</h2>
<ol type="1">
<li>Maak een directory genaamd “BioinformaticaCursus” in je thuisdirectory.</li>
<li>Maak binnen “BioinformaticaCursus” drie subdirectories: “Data”, “Scripts” en “Resultaten”.</li>
<li>Maak een leeg bestand genaamd “notities.txt” in de “BioinformaticaCursus” directory.</li>
<li>Toon de inhoud van “BioinformaticaCursus” in lang formaat.</li>
<li>Verplaats “notities.txt” naar de “Resultaten” directory.</li>
<li>Kopieer “notities.txt” van “Resultaten” naar “Data”.</li>
<li>Verwijder het “notities.txt” bestand uit de “Data” directory.</li>
</ol>
</section>
</section>
<section id="section" class="level1">
<h1></h1>
<p>Open de map van jouw groepje in de VSCode editor:</p>
<p><code>/staging/leuven/stg_00156/bioinformatica-groepswerk/groep01</code></p>
</section>
<section id="kwaliteitscontrole-met-fastqc" class="level1">
<h1>Kwaliteitscontrole met FastQC</h1>
<section id="doel" class="level2">
<h2 class="anchored" data-anchor-id="doel">Doel</h2>
<p>Het hoofddoel van FastQC is om een snelle kwaliteitscontrole uit te voeren op ruwe sequentiedata afkomstig van high-throughput sequencing pijplijnen. Het helpt bij het identificeren van problemen die kunnen voortkomen uit de sequencer zelf of de bibliotheekvoorbereiding.</p>
</section>
<section id="opdrachten" class="level2">
<h2 class="anchored" data-anchor-id="opdrachten">Opdrachten</h2>
<p>Laad de FastQC module</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load FastQC/0.11.8-Java-1.8.0_162</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Voer FastQC uit op beide read-bestanden</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastqc</span> naam_van_fastq_bestand.fastq.gz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Het FastQC rapport wordt gegenereerd, dit duurt enkele seconden. Hierna zie je het rapport (bv <code>naam_van_fastq_bestand_fastqc.html</code>) verschijnen in de linkerbalk. Om het rapport te openen moeten we het eerst downloaden (rechstklikken + download).</p>
</section>
<section id="het-interpreteren-van-het-fastqc-html-rapport" class="level2">
<h2 class="anchored" data-anchor-id="het-interpreteren-van-het-fastqc-html-rapport">Het interpreteren van het FastQC HTML-rapport</h2>
<ol type="1">
<li><p><strong>Basic Statistics</strong>: Geeft een overzicht van het bestand, waaronder totaal aantal sequenties, sequentielengte en GC-gehalte.</p></li>
<li><p><strong>Per base sequence quality</strong>: Toont hoe de kwaliteitsscores (Phred scores) verlopen over de lengte van de reads. De blauwe lijn geeft de gemiddelde kwaliteitscore mee over alle reads. Normaal neemt de kwaliteitscore af met de lengte van de reads. Bij een goede gelukte sequencing blijft het gemiddelde ook naar het einde van de reads toe voldoende hoog.</p>
<ul>
<li>Groen gebied: Goede kwaliteit</li>
<li>Oranje gebied: Redelijke kwaliteit</li>
<li>Rood gebied: Slechte kwaliteit</li>
</ul></li>
<li><p><strong>Per sequence quality scores</strong>: Geeft de verdeling van kwaliteitsscores over alle sequenties. We verwachten een normale verdeling met een gemiddelde hoger dan 30.</p></li>
<li><p><strong>Per base sequentie-inhoud</strong>: Toont de verhoudingen van basen op elke positie.</p></li>
<li><p><strong>Per sequentie GC-inhoud</strong>: Vergelijkt de waargenomen GC-inhoudverdeling met een theoretische normale verdeling.</p></li>
<li><p><strong>Per base N-inhoud</strong>: Toont het percentage van basen op elke positie die niet konden worden bepaald (N).</p></li>
<li><p><strong>Sequentielengteverspreiding</strong>: Voor de meeste platformen zou dit een scherpe piek moeten zijn.</p></li>
<li><p><strong>Sequentieduplicatieniveaus</strong>: Hoge duplicatieniveaus kunnen duiden op PCR-bias.</p></li>
<li><p><strong>Overgerepresenteerde sequenties</strong>: Lijst van sequenties die vaker voorkomen dan verwacht.</p></li>
<li><p><strong>Adapter-inhoud</strong>: Toont de aanwezigheid van vaak gebruikte adapters in je bibliotheek.</p></li>
</ol>
</section>
<section id="opdrachtvragen" class="level2">
<h2 class="anchored" data-anchor-id="opdrachtvragen">Opdrachtvragen:</h2>
<ol type="1">
<li>Hoeveel sequenties/reads zijn er in beide FASTQ files aanwezig?</li>
<li>Wat is de gemiddelde kwaliteitsscore over alle basen en reads?</li>
<li>Hoe verandert de kwaliteitsscore over de lengte van de reads?</li>
</ol>
</section>
</section>
<section id="read-mapping-met-bwa" class="level1">
<h1>Read Mapping met BWA</h1>
<p>BWA (Burrows-Wheeler Aligner) wordt gebruikt om de reads te aligneren tegen een referentiegenoom.</p>
<p>Laad de BWA module</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load BWA/0.7.17-GCC-10.3.0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Aligneer de reads</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="va">REF</span><span class="op">=</span>/staging/leuven/stg_00156/references/hg38.fa</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bwa</span> mem <span class="at">-t</span> 2 <span class="va">$REF</span> naam_van_fastq_bestand_r1.fastq.gz naam_van_fastq_bestand_r2.fastq.gz <span class="op">&gt;</span> aligned.sam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>Pas de namen van de FASTQ bestanden aan naar de namen van jouw bestanden in het bovenstaande commando.</p>
</blockquote>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load SAMtools/1.13-GCC-10.3.0</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="ex">samtools</span> sort aligned.sam <span class="at">-o</span> aligned.sorted.bam</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="ex">samtools</span> index aligned.sorted.bam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">samtools</span> flagstat aligned.sorted.bam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="opdrachtvragen-1" class="level2">
<h2 class="anchored" data-anchor-id="opdrachtvragen-1">Opdrachtvragen:</h2>
<ol type="1">
<li>Hoeveel reads zijn er gealigneerd tegen het referentiegenoom?</li>
<li>Hoeveel van deze reads vormden een correct paar (beide reads mappen met correct orientatie en afstand op hetzelfde chromosoom)?</li>
</ol>
</section>
</section>
<section id="variant-calling-met-bcftools" class="level1">
<h1>Variant Calling met BCFtools</h1>
<p>BCFtools wordt gebruikt om varianten te identificeren uit de uitgelijnde reads.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Roep varianten aan</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bcftools</span> mpileup <span class="at">-f</span> referentiegenoom.fasta monster1.sorted.bam <span class="kw">|</span> <span class="ex">bcftools</span> call <span class="at">-mv</span> <span class="at">-Ob</span> <span class="at">-o</span> monster1.raw.bcf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="variant-filtering" class="level1">
<h1>Variant Filtering</h1>
<p>VCFtools kan worden gebruikt om de varianten te filteren op basis van verschillende criteria.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zet BCF om naar VCF</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bcftools</span> view monster1.raw.bcf <span class="op">&gt;</span> monster1.raw.vcf</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter varianten</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="ex">vcftools</span> <span class="at">--vcf</span> monster1.raw.vcf <span class="dt">\</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">--minQ</span> 30 <span class="dt">\</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">--min-meanDP</span> 10 <span class="dt">\</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">--max-missing</span> 0.8 <span class="dt">\</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="dt">\</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">--out</span> monster1.gefilterd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="variant-annotatie-met-snpeff" class="level1">
<h1>Variant Annotatie met SnpEff</h1>
<section id="stap-1-installeer-snpeff" class="level2">
<h2 class="anchored" data-anchor-id="stap-1-installeer-snpeff">Stap 1: Installeer SnpEff</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://snpeff.blob.core.windows.net/versions/snpEff_latest_core.zip</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span> snpEff_latest_core.zip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stap-2-download-de-human-genome-database" class="level2">
<h2 class="anchored" data-anchor-id="stap-2-download-de-human-genome-database">Stap 2: Download de Human Genome Database</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">java</span> <span class="at">-jar</span> snpEff.jar download <span class="at">-v</span> hg38</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stap-3-voer-snpeff-uit" class="level2">
<h2 class="anchored" data-anchor-id="stap-3-voer-snpeff-uit">Stap 3: Voer SnpEff uit</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">java</span> <span class="at">-Xmx4g</span> <span class="at">-jar</span> snpEff.jar hg38 input_varianten.vcf <span class="op">&gt;</span> geannoteerde_varianten.vcf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stap-4-interpreteer-de-resultaten" class="level2">
<h2 class="anchored" data-anchor-id="stap-4-interpreteer-de-resultaten">Stap 4: Interpreteer de Resultaten</h2>
<p>Kijk naar het <code>ANN</code> veld in de output VCF voor gedetailleerde annotaties.</p>
</section>
<section id="opdrachtvragen-2" class="level2">
<h2 class="anchored" data-anchor-id="opdrachtvragen-2">Opdrachtvragen</h2>
<ol type="1">
<li>Hoeveel varianten met HOGE impact heb je gevonden? Wat voor soort varianten zijn dit?</li>
<li>Vind een missense variant. Wat is de aminozuurverandering? In welk gen kwam het voor?</li>
<li>Zijn er varianten in bekende ziekte-geassocieerde genen?</li>
<li>Wat is het meest voorkomende type variant in je dataset?</li>
<li>Kun je varianten vinden die de eiwitfunctie kunnen beïnvloeden? Leg uit waarom je denkt dat ze impactvol kunnen zijn.</li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>